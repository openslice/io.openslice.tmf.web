<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top mat-elevation-z4" role="navigation">
				
    <!-- <div class="container-fluid"> -->
        <!-- Brand and toggle get grouped for better mobile display -->
            <!-- <button type="button" class="navbar-toggle" data-toggle="collapse"
                data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span> <span
                    class="icon-bar"></span> <span class="icon-bar"></span> <span
                    class="icon-bar"></span>
            </button> -->
        <a *ngIf="loggedIn" class="navbar-brand" routerLink="/">
            <img src="assets/images/logo_clear.png" height="25px">
        </a>
        <a *ngIf="!loggedIn" class="navbar-brand" routerLink="/">
            <img src="assets/images/logo_clear.png" height="25px">
        </a>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <button class="navbar-toggler" type="button" (click)="isNavbarCollapsed = !isNavbarCollapsed" 
            aria-controls="navbarsDefault" 
            [attr.aria-expanded]="!isNavbarCollapsed"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div [ngbCollapse]="isNavbarCollapsed" class="collapse navbar-collapse" id="navbarsDefault">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item" routerLinkActive="active">
                    <a class="nav-link" routerLink="/services_marketplace">Services Marketplace</a>
                </li>
                <!-- <li class="nav-item" routerLinkActive="active">
                    <a class="nav-link" routerLink="/experiments_marketplace">Experiments</a>
                </li>
                <li class="nav-item" routerLinkActive="active">
                    <a class="nav-link" routerLink="/vxf_marketplace">VxFs</a>
                </li> -->

                <li class="nav-item" routerLinkActive="active" *ngIf="(authService.isAuthenticated$ | async) && !authService.portalUserJWT?.realm_access.roles.includes('ADMIN')" [@fadeIn]>
                    <a class="nav-link" routerLink="/my_service_orders">My Service Orders</a>
                </li>
                
                <li class="nav-item" routerLinkActive="active" *ngIf="(authService.isAuthenticated$ | async) && !authService.portalUserJWT?.realm_access.roles.includes('ADMIN')" [@fadeIn]>
                    <a class="nav-link" routerLink="/service_inventory">My Service Inventory</a>
                </li>


                <li class="nav-item dropdown" ngbDropdown *ngIf="(authService.isAuthenticated$ | async) && authService.portalUserJWT?.realm_access.roles.includes('ADMIN')" [@fadeIn]>
                    <a class="nav-link dropdown-toggle" id="navbarDropdown" aria-haspopup="true" ngbDropdownToggle tabindex="0">Manage Services
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown" ngbDropdownMenu>
                            <!-- <div class="optgroup-label">Catalog Management</div> -->
                            <li><a class="dropdown-item" tabindex="0" routerLink="/service_catalogs">Service Catalogs</a></li>
                            <li><a class="dropdown-item" tabindex="0" routerLink="/service_categories">Service Categories</a></li>
                            <!-- <li><a class="dropdown-item" tabindex="-1" routerLink="/service_specs">Service Specifications</a></li> -->
                            <li class="dropdown dropdown-submenu" ngbDropdown>
                                <a class="dropdown-toggle" id="navbarDropdown1" aria-haspopup="true" ngbDropdownToggle tabindex="0">Service Specifications</a>
                                <ul class="dropdown-menu" aria-labelledby="navbarDropdown1" ngbDropdownMenu>
                                        <li><a class="dropdown-item" tabindex="0" routerLink="/service_specs">List Service Specifications</a></li>
                                        <li><a class="dropdown-item" tabindex="0" routerLink="/service_spec_update">New Service Specification</a></li>
                                        <div class="dropdown-divider"></div>
                                        <!-- <div class="optgroup-label">Choose from Templates</div> -->
                                        <li><a class="dropdown-item clone-item" tabindex="0" (click)="onGSTtemplateClick()">New GST External</a></li>
                                        <li><a class="dropdown-item clone-item" tabindex="0" (click)="onVINNItemplateClick()">New VINNI-SB</a></li>
                                </ul>
                            </li>
                            <li><a class="dropdown-item" tabindex="0" routerLink="/list_nsds">Import from NSD list</a></li>
                            <div class="dropdown-divider"></div>
                            <!-- <div class="optgroup-label">Order Management</div> -->
                            <li><a class="dropdown-item" tabindex="0" routerLink="/service_orders">Service Orders</a></li> 
                            <!-- <a class="dropdown-item">More</a> -->
                            <div class="dropdown-divider"></div>
                            <!-- <div class="optgroup-label">Order Management</div> -->
                            <li><a class="dropdown-item" tabindex="0" routerLink="/service_inventory">Service Inventory</a></li> 

                        </ul>
                    </a>
                </li>

                <li class="nav-item dropdown" ngbDropdown *ngIf="(authService.isAuthenticated$ | async) && authService.portalUserJWT?.realm_access.roles.includes('ADMIN')" [@fadeIn]>
                    <a class="nav-link dropdown-toggle" id="navbarDropdown" aria-haspopup="true" ngbDropdownToggle tabindex="0">Manage Entities
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown" ngbDropdownMenu>
                            <!-- <div class="optgroup-label">Catalog Management</div> -->
                            <li><a class="dropdown-item" tabindex="0" routerLink="/organizations">Organizations</a></li>
                            <li><a class="dropdown-item" tabindex="0" routerLink="/individuals">Individuals</a></li>
                            <!-- <li><a class="dropdown-item" tabindex="-1" routerLink="/service_specs">Service Specifications</a></li> -->
                        </ul>
                    </a>
                </li>

                <li class="nav-item dropdown" ngbDropdown *ngIf="(authService.isAuthenticated$ | async) && authService.portalUserJWT?.realm_access.roles.includes('ADMIN')" [@fadeIn]>
                    <a class="nav-link dropdown-toggle" id="navbarDropdown" aria-haspopup="true" ngbDropdownToggle tabindex="0">Monitoring
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown" ngbDropdownMenu>
                            <li><a class="dropdown-item" tabindex="0" routerLink="/alarms">Alarms</a></li>
                            <li><a class="dropdown-item" tabindex="0" routerLink="/action_specs">Action Specifications</a></li>
                            <li><a class="dropdown-item" tabindex="0" routerLink="/action_rules">Action Rules</a></li>
                            <!-- <li><a class="dropdown-item" tabindex="-1" routerLink="/service_specs">Service Specifications</a></li> -->
                        </ul>
                    </a>
                </li>
            </ul>

            <ng-container *ngIf="authService.isAuthenticated$ | async; else elseTemplate">
                <ul class="navbar-nav">

                        <li class="nav-item" [@fadeIn]>
                            <a class="nav-link d-flex align-items-center" routerLink="/service_order_checkout">
                                <span class="badge badge-danger mr-1"> {{requesterService.orderedSpecsList.length}} </span>
                                <i class="fas fa-shopping-cart mr-1"></i>
                                <span> Order List </span>
                            </a>
                        </li>

                        <li class="nav-item dropdown" ngbDropdown *ngIf="authService.portalUser" [@fadeIn]>
                            <a class="nav-link dropdown-toggle" id="navbarDropdown2" aria-haspopup="true" ngbDropdownToggle tabindex="-1">{{authService.portalUserJWT.preferred_username}}</a>
                            <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown2" ngbDropdownMenu>
                                <li class="user-info">Name: {{authService.portalUser.familyName}} {{authService.portalUser.givenName}}</li>
                                <li class="user-info">Organization: 
                                    <span *ngFor="let characteristic of authService.portalUser.partyCharacteristic">
                                        <span *ngIf="characteristic.name === 'organization'"> {{characteristic.value.value}}
                                        </span>
                                    </span>
                                </li>
                                <li class="user-info">Email: {{authService.portalUser.contactMedium[0].characteristic.emailAddress}}</li>
                                <li class="user-info">Roles: <span *ngFor="let role of authService.portalUserJWT.realm_access.roles; let last = last">{{role | titlecase}}<span *ngIf="!last">, </span></span></li>
 
                                <div class="dropdown-divider"></div>
                                <li class="dropdown-item" routerLink='/individual_update/myuser' >
                                    <a class="dropdown-link" ><i class="far fa-edit mr-2"></i>Edit my profile</a>
                                </li>
                                
                                <div class="dropdown-divider"></div>
                                <li class="dropdown-item" (click)="logout()" >
                                    <a class="dropdown-link" ><i class="fas fa-sign-out-alt mr-2"></i>Sign out</a>
                                </li>
                            </ul>
                        </li>
                </ul> 
            </ng-container>
            <ng-template #elseTemplate>
                <ul class="navbar-nav">
                    <li class="nav-item" [@fadeIn]>
                        <a class="nav-link" (click)="login()">Sign in</a>
                    </li>
                </ul> 
            </ng-template>

        </div>

    <!-- </div> -->
</nav>